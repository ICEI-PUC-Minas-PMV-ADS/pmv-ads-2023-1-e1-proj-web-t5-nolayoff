var db_vagas_inicial = {
    "data": [
        {
            "id": 1,
            "descricao": "Analista de TI - DB APOIO INTEGRAL.",
            "empresa" : "wabtec" ,
            'sobreaempresa' :"With more than 27,000 employees in over 50 countries around the world, Wabtec provides innovative solutions to our freight rail, passenger transit and industrial customers. Our history of innovation dates back a century and a half to George Westinghouse's invention of the air brake.",
            'sobreavaga' :"Empresa localizada na cidade de contagem/ mg do ramo administrativo contrata analista de ti Requisitos: • desejável ensino superior completo em tecnologia da informação ou áreas afins.",
            "tempo": "Integral",
            "cargo" : "Analista de sistemas",
            "competenciadavaga" : "CSS;Desenvolvimento de back-end;ERP;Go;HTML;JQuery;JavaScript:Lógica;PHP",
            "salario": "3500,00",
            "email": "wabtec@wabtec.email.com",
            "telefone": "31-322-736-8031",
            "website": "http://wabtec.com"
        
        },
        {
            "id": 2,
            "descricao": "Analista de TI - DB APOIO INTEGRAL.",
            "empresa" : "ADESCOLA" ,
            'sobreaempresa' :"With more than 27,000 employees in over 50 countries around the world, Wabtec provides innovative solutions to our freight rail, passenger transit and industrial customers. Our history of innovation dates back a century and a half to George Westinghouse's invention of the air brake.",
            'sobreavaga' :"Empresa localizada na cidade de contagem/ mg do ramo administrativo contrata analista de ti Requisitos: • desejável ensino superior completo em tecnologia da informação ou áreas afins.",
            "tempo": "Integral",
            "cargo" : "Analista de sistemas",
            "competenciadavaga" : "CSS;Desenvolvimento de back-end;ERP;Go;HTML;JQuery;JavaScript:Lógica;PHP",
            "salario": "3500,00",
            "email": "wabtec@wabtec.email.com",
            "telefone": "31-322-736-8031",
            "website": "http://wabtec.com"
        },
        {
            "id": 3,
            "descricao": "Analista de TI - DB APOIO INTEGRAL.",
            "empresa" : "wabtec" ,
            'sobreaempresa' :"With more than 27,000 employees in over 50 countries around the world, Wabtec provides innovative solutions to our freight rail, passenger transit and industrial customers. Our history of innovation dates back a century and a half to George Westinghouse's invention of the air brake.",
            'sobreavaga' :"Empresa localizada na cidade de contagem/ mg do ramo administrativo contrata analista de ti Requisitos: • desejável ensino superior completo em tecnologia da informação ou áreas afins.",
            "tempo": "Integral",
            "cargo" : "Analista de sistemas",
            "competenciadavaga" : "CSS;Desenvolvimento de back-end;ERP;Go;HTML;JQuery;JavaScript:Lógica;PHP",
            "salario": "3500,00",
            "email": "wabtec@wabtec.email.com",
            "telefone": "31-322-736-8031",
            "website": "http://wabtec.com"
        },
        {
            "id": 4,
            "descricao": "Analista de TI - DB APOIO INTEGRAL.",
            "empresa" : "wabtec" ,
            'sobreaempresa' :"With more than 27,000 employees in over 50 countries around the world, Wabtec provides innovative solutions to our freight rail, passenger transit and industrial customers. Our history of innovation dates back a century and a half to George Westinghouse's invention of the air brake.",
            'sobreavaga' :"Empresa localizada na cidade de contagem/ mg do ramo administrativo contrata analista de ti Requisitos: • desejável ensino superior completo em tecnologia da informação ou áreas afins.",
            "tempo": "Integral",
            "cargo" : "Analista de sistemas",
            "competenciadavaga" : "CSS;Desenvolvimento de back-end;ERP;Go;HTML;JQuery;JavaScript:Lógica;PHP",
            "salario": "3500,00",
            "email": "wabtec@wabtec.email.com",
            "telefone": "31-322-736-8031",
            "website": "http://wabtec.com"
        },
        {
            "id": 5,
            "descricao": "Analista de TI - DB APOIO INTEGRAL.",
            "empresa" : "wabtec" ,
            'sobreaempresa' :"With more than 27,000 employees in over 50 countries around the world, Wabtec provides innovative solutions to our freight rail, passenger transit and industrial customers. Our history of innovation dates back a century and a half to George Westinghouse's invention of the air brake.",
            'sobreavaga' :"Empresa localizada na cidade de contagem/ mg do ramo administrativo contrata analista de ti Requisitos: • desejável ensino superior completo em tecnologia da informação ou áreas afins.",
            "tempo": "Integral",
            "cargo" : "Analista de sistemas",
            "competenciadavaga" : "CSS;Desenvolvimento de back-end;ERP;Go;HTML;JQuery;JavaScript:Lógica;PHP",
            "salario": "3500,00",
            "email": "wabtec@wabtec.email.com",
            "telefone": "31-322-736-8031",
            "website": "http://wabtec.com"
        },
        {
            "id": 6,
            "descricao": "Analista de TI - DB APOIO INTEGRAL.",
            "empresa" : "wabtec" ,
            'sobreaempresa' :"With more than 27,000 employees in over 50 countries around the world, Wabtec provides innovative solutions to our freight rail, passenger transit and industrial customers. Our history of innovation dates back a century and a half to George Westinghouse's invention of the air brake.",
            'sobreavaga' :"Empresa localizada na cidade de contagem/ mg do ramo administrativo contrata analista de ti Requisitos: • desejável ensino superior completo em tecnologia da informação ou áreas afins.",
            "tempo": "Integral",
            "cargo" : "Analista de sistemas",
            "competenciadavaga" : "CSS;Desenvolvimento de back-end;ERP;Go;HTML;JQuery;JavaScript:Lógica;PHP",
            "salario": "3500,00",
            "email": "wabtec@wabtec.email.com",
            "telefone": "31-322-736-8031",
            "website": "http://wabtec.com"
        },
        {
            "id": 7,
            "descricao": "Analista de TI - DB APOIO INTEGRAL.",
            "empresa" : "wabtec" ,
            'sobreaempresa' :"With more than 27,000 employees in over 50 countries around the world, Wabtec provides innovative solutions to our freight rail, passenger transit and industrial customers. Our history of innovation dates back a century and a half to George Westinghouse's invention of the air brake.",
            'sobreavaga' :"Empresa localizada na cidade de contagem/ mg do ramo administrativo contrata analista de ti Requisitos: • desejável ensino superior completo em tecnologia da informação ou áreas afins.",
            "tempo": "Integral",
            "cargo" : "Analista de sistemas",
            "competenciadavaga" : "CSS;Desenvolvimento de back-end;ERP;Go;HTML;JQuery;JavaScript:Lógica;PHP",
            "salario": "3500,00",
            "email": "wabtec@wabtec.email.com",
            "telefone": "31-322-736-8031",
            "website": "http://wabtec.com"
        },
        {
            "id": 8,
            "descricao": "Analista de TI - DB APOIO INTEGRAL.",
            "empresa" : "wabtec" ,
            'sobreaempresa' :"With more than 27,000 employees in over 50 countries around the world, Wabtec provides innovative solutions to our freight rail, passenger transit and industrial customers. Our history of innovation dates back a century and a half to George Westinghouse's invention of the air brake.",
            'sobreavaga' :"Empresa localizada na cidade de contagem/ mg do ramo administrativo contrata analista de ti Requisitos: • desejável ensino superior completo em tecnologia da informação ou áreas afins.",
            "tempo": "Integral",
            "cargo" : "Analista de sistemas",
            "competenciadavaga" : "CSS;Desenvolvimento de back-end;ERP;Go;HTML;JQuery;JavaScript:Lógica;PHP",
            "salario": "3500,00",
            "email": "wabtec@wabtec.email.com",
            "telefone": "31-322-736-8031",
            "website": "http://wabtec.com"
        },
        {
            "id": 9,
            "descricao": "Analista de TI - DB APOIO INTEGRAL.",
            "empresa" : "wabtec" ,
            'sobreaempresa' :"With more than 27,000 employees in over 50 countries around the world, Wabtec provides innovative solutions to our freight rail, passenger transit and industrial customers. Our history of innovation dates back a century and a half to George Westinghouse's invention of the air brake.",
            'sobreavaga' :"Empresa localizada na cidade de contagem/ mg do ramo administrativo contrata analista de ti Requisitos: • desejável ensino superior completo em tecnologia da informação ou áreas afins.",
            "tempo": "Integral",
            "cargo" : "Analista de sistemas",
            "competenciadavaga" : "CSS;Desenvolvimento de back-end;ERP;Go;HTML;JQuery;JavaScript:Lógica;PHP",
            "salario": "3500,00",
            "email": "wabtec@wabtec.email.com",
            "telefone": "31-322-736-8031",
            "website": "http://wabtec.com"
        },
        {
            "id": 10,
            "descricao": "Analista de TI - DB APOIO INTEGRAL.",
            "empresa" : "wabtec" ,
            'sobreaempresa' :"With more than 27,000 employees in over 50 countries around the world, Wabtec provides innovative solutions to our freight rail, passenger transit and industrial customers. Our history of innovation dates back a century and a half to George Westinghouse's invention of the air brake.",
            'sobreavaga' :"Empresa localizada na cidade de contagem/ mg do ramo administrativo contrata analista de ti Requisitos: • desejável ensino superior completo em tecnologia da informação ou áreas afins.",
            "tempo": "Integral",
            "cargo" : "Analista de sistemas",
            "competenciadavaga" : "CSS;Desenvolvimento de back-end;ERP;Go;HTML;JQuery;JavaScript:Lógica;PHP",
            "salario": "3500,00",
            "email": "wabtec@wabtec.email.com",
            "telefone": "31-322-736-8031",
            "website": "http://wabtec.com"
        }
    ]
}

var AuxCompetencias = {
    "data":[
        {
            "id": "1",
            "descricao":  "Desenvolvimento de back-end",
        },
        {
            "id": "2",
            "descricao":  "CSS",
        },
        {
            "id": "3",
            "descricao":  "Desenvolvimento de Front-end",
        },
        {
            "id": "4",
            "descricao":  "ERP",
        },
        {
            "id": "5",
            "descricao":  "Go",
        },
        {
            "id": "6",
            "descricao":  "JQuery",
        },
        {
            "id": "7",
            "descricao":  "JavaScript",
        },
        {
            "id": "8",
            "descricao":  "Lógica",
        },
        {
            "id": "9",
            "descricao":  "PHP",
        },
        {
            "id": "10",
            "descricao":  "html",
        },
        {
            "id": "11",
            "descricao":  "html5",
        },
        {
            "id": "12",
            "descricao":  "delphi",
        },
        {
            "id": "13",
            "descricao":  "React",
        },
        {
            "id": "14",
            "descricao":  "React-native",
        },
        {
            "id": "15",
            "descricao":  "html5",
        },
        {
            "id": "16",
            "descricao":  "Banco de Dados",
        },
        {
            "id": "17",
            "descricao":  "web Design",
        },
        {
            "id": "18",
            "descricao":  "UX/UI",
        },
        {
            "id": "19",
            "descricao":  "AngularJS",
        },
        {
            "id": "20",
            "descricao":  "Java",
        },
        {
            "id": "21",
            "descricao":  "Hibernate",
        },
        {
            "id": "22",
            "descricao":  "Entity Framework",
        },
        {
            "id": "23",
            "descricao":  "Spring",
        },
        {
            "id": "24",
            "descricao":  "MS SQL Server",
        },
        {
            "id": "25",
            "descricao":  "Oracle",
        },
        {
            "id": "26",
            "descricao":  "VueJS",
        },
        {
            "id": "27",
            "descricao":  "NodeJS",
        },
        {
            "id": "28",
            "descricao":  "Python",
        },
        {
            "id": "29",
            "descricao":  "Ionics",
        },
        {
            "id": "30",
            "descricao":  "Quasar",
        },
        {
            "id": "31",
            "descricao":  "C#",
        },
        {
            "id": "32",
            "descricao":  "Docker",
        },
        {
            "id": "33",
            "descricao":  "Flutter",
        },
        {
            "id": "34",
            "descricao":  "MS Azure Devops",
        },
        {
            "id": "35",
            "descricao":  "Flyway",
        }

]};

// Caso os dados já estejam no Local Storage, caso contrário, carrega os dados iniciais
var db = JSON.parse(localStorage.getItem('db_vagas'));
if (!db) {
    db = db_vagas_inicial
};

// Exibe mensagem em um elemento de ID msg
function displayMessage(msg) {
    $('#msg').html('<div class="alert alert-warning">' + msg + '</div>');
}

function insertVaga(vaga) {
    // Calcula novo Id a partir do último código existente no array (PODE GERAR ERRO SE A BASE ESTIVER VAZIA)
    let novoId = 1;
    if (db.data.length != 0) 
      novoId = db.data[db.data.length - 1].id + 1;
    let novaVaga = {
        "id": novoId,
        "descricao": vaga.descricao,
        "empresa" : vaga.empresa,
        "sobreaempresa": vaga.sobreaempresa,
        "sobreavaga" : vaga.sobreavaga,
        "tempo": vaga.tempo,
        "cargo" : vaga.cargo,
        "competenciadavaga": vaga.competenciadavaga,
        "salario": vaga.salario,
        "email": vaga.email,
        "telefone":vaga.telefone,
        "website":vaga.website,
    };

    // Insere o novo objeto no array
    db.data.push(novaVaga);
    displayMessage("Vaga inserida com sucesso");

    // Atualiza os dados no Local Storage
    localStorage.setItem('db_vagas', JSON.stringify(db));
}

function updateVaga(id, vaga) {
    // Localiza o indice do objeto a ser alterado no array a partir do seu ID
    let index = db.data.map(obj => obj.id).indexOf(id);

    // Altera os dados do objeto no array
    db.data[index].descricao = vaga.descricao,
    db.data[index].empresa = vaga.empresa,
    db.data[index].sobreaempresa = vaga.sobreaempresa,
    db.data[index].sobreavaga = vaga.sobreavaga,
    db.data[index].tempo = vaga.tempo,
    db.data[index].cargo = vaga.cargo,
    db.data[index].competenciadavaga = vaga.competenciadavaga,
    db.data[index].salario = vaga.salario,
    db.data[index].email = vaga.email
    db.data[index].telefone = vaga.telefone
    db.data[index].website = vaga.website

    displayMessage("Vaga alterada com sucesso");

    // Atualiza os dados no Local Storage
    localStorage.setItem('db_vagas', JSON.stringify(db));
}

function deleteVaga(id) {    
    // Filtra o array removendo o elemento com o id passado
    db.data = db.data.filter(function (element) { return element.id != id });

    displayMessage("Vaga removida com sucesso");

    // Atualiza os dados no Local Storage
    localStorage.setItem('db_vagas', JSON.stringify(db));
}